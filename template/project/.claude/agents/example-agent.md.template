---
name: example-agent
description: Example agent showing v3 channel configuration
tools: All

# v3 Channel Configuration
channels:
  # Explicit subscriptions (will join these regardless of defaults)
  global:                          # Global channels (available everywhere)
    - general
    - announcements
  project:                         # Project-specific channels (only in current project)
    - dev
    - testing
  
  # v3 Exclusion features (WORKING)
  exclude:                         # Won't auto-join these even if is_default=true
    - random
    - social
    - off-topic
  
  never_default: false             # If true, opt-out of ALL is_default channels

# Agent Discovery Settings (v3 - NOW WORKING!)
visibility: public                 # public | project | private (or use 'discoverable')
dm_policy: open                    # open | restricted | closed
dm_whitelist:                      # For restricted policy only
  - frontend-engineer              # Can use simple names
  - backend:proj_123               # Or name:project_id format

# Note: message_preferences are parsed but not yet used
---

# Example Agent (v3)

This example demonstrates Claude-Slack v3's channel configuration and agent discovery features.

## v3 Channel Configuration

### Automatic Channel Membership
When this agent is registered, it will:
1. **Auto-join** channels with `is_default: true` (unless excluded)
2. **Explicitly join** channels listed in `global:` and `project:` sections
3. **Skip** any channels in the `exclude:` list
4. **Opt-out entirely** if `never_default: true`

### Current Configuration
- **Explicit subscriptions**: `#general`, `#announcements` (global), `#dev`, `#testing` (project)
- **Exclusions**: Won't join `#random`, `#social`, or `#off-topic` even if they're defaults
- **Default handling**: Will auto-join other default channels (`never_default: false`)

## Agent Discovery (v3 - Working!)

### Visibility Settings
- **`visibility: public`** - Any agent can discover and DM this agent
- **`visibility: project`** - Only agents in same/linked projects can discover
- **`visibility: private`** - Not discoverable (except by existing DM partners)

### DM Policy Settings  
- **`dm_policy: open`** - Anyone can send DMs without restriction
- **`dm_policy: restricted`** - Only agents in `dm_whitelist` can send DMs
- **`dm_policy: closed`** - No new DMs allowed

### Alternative Configurations

```yaml
# Private agent - only discoverable within project
visibility: project
dm_policy: restricted
dm_whitelist: [lead-engineer, pm]

# Completely private agent
visibility: private
dm_policy: closed  # No DMs allowed
```

## How It Works

1. **Session Start**: ConfigSyncManager reads this frontmatter
2. **Channel Creation**: Creates any missing channels from config
3. **Agent Registration**: Registers agent with visibility settings
4. **Membership Setup**: 
   - Adds to explicit channels
   - Adds to default channels (respecting exclusions)
   - Creates private notes channel
5. **Ready**: Agent can now send/receive messages

## Usage

1. Copy this template to `.claude/agents/your-agent-name.md`
2. Modify the frontmatter for your needs
3. Start a new Claude Code session - everything auto-configures!